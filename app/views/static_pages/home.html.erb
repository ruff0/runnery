<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>

<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<% provide(:title, 'Home') %>

<div class="container">

    <% if signed_in? %>
     <% if !driver? %>
      
      <div class="span4">
        <%= render 'shared/order_form'%>
      </div>

     <% end %>
    
     <% if driver? %>

      <section class="span4 pull-left">
        <h3>Waiting:</h3>
        <%= render 'shared/feed' %>
      </section>

      <div class= "pull-right" style='width: 500px;'><h3>Restaurants Map:</h3>
  <div  id="map" style='width: 500px; height: 600px;'></div>
</div>

<script type="text/javascript">
handler = Gmaps.build('Google');
handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
  markers = handler.addMarkers(<%=raw @hash.to_json %>);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});
</script>

     <% else %>

        <row class="span4">
            <h3>Waiting:</h3>
          <%= render 'shared/feed' %>
        </row>

     <% end %>

    </div>

<% else %>

	<div class="container">
  		<div class="span4">

    	<%= form_for(:session, url: sessions_path) do |f| %>

      	<%= f.label :phone %>
      	<%= f.text_field :phone, placeholder: "8885551234" %>

      	<%= f.label :password %>
      	<%= f.password_field :password %>

      	<%= f.submit "Sign in!", class: "btn btn-large btn-inverse" %>

   		<% end %>

  		</div>
	</div>

  
      <div class="container offset">

		    <%= link_to "Register!", signup_path, class: "btn" %>

      </div>
    </div>

  <% end %>

			



		

